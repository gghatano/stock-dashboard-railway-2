# 知見管理ガイド

プロジェクトの知見をどこに記載すべきかのガイドです。

## 配置先一覧

| 知見の種類 | 配置先 | 更新タイミング |
|-----------|--------|---------------|
| プロジェクト全体ルール | `CLAUDE.md` | ワークフロー変更時 |
| 役割の動作ルール | `.claude/skills/*/SKILL.md` | 役割の振る舞い変更時 |
| 役割の詳細知識 | `.claude/skills/*/*.md` | パターン・例の追加時 |
| プロジェクト固有の技術知見 | `doc/project_knowledge.md` | 技術的発見時 |
| 仕様・要件 | `doc/仕様書.md` | 要件変更時 |
| タスク・進捗 | `doc/開発方針.md` | タスク状況変化時 |

## 判断フローチャート

```
知見を追加したい
    │
    ├─ 全コマンド共通のルール？
    │      └─ Yes → CLAUDE.md
    │
    ├─ 特定の役割に関連？
    │      ├─ 動作ルール → .claude/skills/*/SKILL.md
    │      └─ 詳細・例 → .claude/skills/*/*.md
    │
    ├─ このプロジェクト固有の技術？
    │      └─ Yes → doc/project_knowledge.md
    │
    └─ 仕様・タスク関連？
           ├─ 機能要件 → doc/仕様書.md
           └─ タスク管理 → doc/開発方針.md
```

## 各ファイルの役割

### CLAUDE.md
**プロジェクト全体の最重要ルール**

記載すべき内容:
- 実装権限のルール（`/eng` のみ実装可能）
- ワークフローの概要
- コマンドの使い分け
- ディレクトリ構造の概要

記載しない内容:
- 詳細なコード例（→ skills/へ）
- プロジェクト固有の技術詳細（→ project_knowledge.mdへ）

### .claude/skills/*/SKILL.md
**各役割の動作ルール（簡潔に）**

記載すべき内容:
- 役割の定義（1-2行）
- 主な責務（箇条書き）
- 出力フォーマット
- 基本原則

記載しない内容:
- 長いコード例（→ サブファイルへ）
- 詳細なチェックリスト（→ サブファイルへ）

### .claude/skills/*/*.md（サブファイル）
**役割の詳細知識**

| ファイル名 | 内容 |
|-----------|------|
| `EXAMPLES.md` | コード例、対話例 |
| `CHECKLIST.md` | 詳細なチェックリスト |
| `*_PATTERNS.md` | パターン集 |

### doc/project_knowledge.md
**プロジェクト固有の技術知見**

記載すべき内容:
- 使用ライブラリとバージョン
- API仕様・エンドポイント
- DB構造・テーブル定義
- 環境変数・設定
- プロジェクト固有の規約
- 過去のトラブルと解決策

## 知見追加の手順

### 方法1: `/knowledge` コマンドを使用
```
/knowledge [種類] [内容]

種類:
- project: プロジェクト固有の技術知見
- skill:[役割名]: 役割固有の知見
- rule: 全体ルール
```

### 方法2: 直接編集
1. このガイドで配置先を確認
2. `/eng` で該当ファイルを編集

## 知見の品質基準

### 良い知見の例
```
## 認証トークンの有効期限
- アクセストークン: 1時間
- リフレッシュトークン: 7日
- 理由: セキュリティとUXのバランス
```

### 避けるべき例
```
## トークン
1時間です
```
→ 具体性がない、理由がない

## 定期レビュー

月1回程度、以下を確認:
- [ ] 古くなった知見はないか
- [ ] 重複している記載はないか
- [ ] 配置場所は適切か
- [ ] SKILL.mdが肥大化していないか（目安: 80行以下）
